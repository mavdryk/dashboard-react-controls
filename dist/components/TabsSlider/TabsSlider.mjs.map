{"version":3,"file":"TabsSlider.mjs","sources":["../../../src/lib/components/TabsSlider/TabsSlider.jsx"],"sourcesContent":["/*\nCopyright 2019 Iguazio Systems Ltd.\n\nLicensed under the Apache License, Version 2.0 (the \"License\") with\nan addition restriction as set forth herein. You may not use this\nfile except in compliance with the License. You may obtain a copy of\nthe License at http://www.apache.org/licenses/LICENSE-2.0.\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\nimplied. See the License for the specific language governing\npermissions and limitations under the License.\n\nIn addition, you may not use the software for any purposes that are\nillegal under applicable law, and the grant of the foregoing license\nunder the Apache 2.0 license is conditioned upon your compliance with\nsuch restriction.\n*/\nimport React, { useCallback, useEffect, useState, useRef } from 'react'\nimport { Link, useLocation, useParams } from 'react-router-dom'\nimport PropTypes from 'prop-types'\nimport classnames from 'classnames'\n\nimport Tip from '../Tip/Tip'\n\nimport { SLIDER_TABS } from '../../types'\nimport { generateUrlFromRouterPath } from '../../utils/common.util'\n\nimport Arrow from '../../images/arrow.svg?react'\n\nconst TabsSlider = ({\n  fontSize = 'sm',\n  initialTab = '',\n  isDetailsPopUp = false,\n  onClick = () => {},\n  skipLink = false,\n  tabsList\n}) => {\n  const [selectedTab, setSelectedTab] = useState(initialTab)\n  const [arrowsAreHidden, setArrowsAreHidden] = useState(true)\n  const [scrolledWidth, setScrolledWidth] = useState(0)\n  const [rightArrowDisabled, setRightArrowDisabled] = useState(false)\n  const tabsWrapperRef = useRef()\n  const tabsRef = useRef()\n  const location = useLocation()\n  const params = useParams()\n  const menuOffsetHalfWidth = 2\n  const tabOffset = 1.5\n\n  const leftArrowClassNames = classnames(\n    'tabs-slider__arrow',\n    'tabs-slider__arrow_left',\n    arrowsAreHidden && 'tabs-slider__arrow_hidden',\n    scrolledWidth === 0 && 'tabs-slider__arrow_disabled'\n  )\n  const rightArrowClassNames = classnames(\n    'tabs-slider__arrow',\n    'tabs-slider__arrow_right',\n    arrowsAreHidden && 'tabs-slider__arrow_hidden',\n    rightArrowDisabled && 'tabs-slider__arrow_disabled'\n  )\n\n  const scrollTabs = toRight => {\n    let scrollWidth\n\n    if (toRight) {\n      if (\n        tabsRef.current?.scrollWidth <\n        tabsWrapperRef.current?.offsetWidth * tabOffset + scrolledWidth\n      ) {\n        scrollWidth = tabsRef.current?.scrollWidth - tabsWrapperRef.current?.offsetWidth\n\n        setRightArrowDisabled(true)\n      } else {\n        scrollWidth = scrolledWidth + tabsWrapperRef.current?.offsetWidth / menuOffsetHalfWidth\n      }\n    } else {\n      scrollWidth = Math.max(\n        0,\n        scrolledWidth - tabsWrapperRef.current?.offsetWidth / menuOffsetHalfWidth\n      )\n\n      setRightArrowDisabled(false)\n    }\n\n    setScrolledWidth(scrollWidth)\n  }\n\n  const handleHideArrows = useCallback(() => {\n    const scrollIsHidden = tabsRef.current?.offsetWidth === tabsRef.current?.scrollWidth\n\n    setArrowsAreHidden(scrollIsHidden)\n\n    if (rightArrowDisabled) {\n      setScrolledWidth(tabsRef.current?.scrollWidth - tabsWrapperRef.current?.offsetWidth)\n    }\n\n    if (scrollIsHidden) {\n      setScrolledWidth(0)\n      setRightArrowDisabled(false)\n    }\n  }, [rightArrowDisabled, tabsRef, tabsWrapperRef])\n\n  const moveToSelectedTab = useCallback(() => {\n    const selectedTabNode = document.querySelector(`[data-tab='${selectedTab}']`)\n    const centeredTabPosition =\n      selectedTabNode?.offsetLeft -\n      tabsWrapperRef.current?.offsetWidth / menuOffsetHalfWidth +\n      selectedTabNode?.offsetWidth / menuOffsetHalfWidth\n\n    if (centeredTabPosition <= 0) {\n      setScrolledWidth(0)\n      setRightArrowDisabled(false)\n    } else if (\n      tabsRef.current?.scrollWidth <\n      tabsWrapperRef.current?.offsetWidth / menuOffsetHalfWidth +\n        selectedTabNode?.offsetLeft +\n        selectedTabNode?.offsetWidth\n    ) {\n      setScrolledWidth(tabsRef.current?.scrollWidth - tabsWrapperRef.current?.offsetWidth)\n      setRightArrowDisabled(true)\n    } else {\n      setScrolledWidth(centeredTabPosition)\n      setRightArrowDisabled(false)\n    }\n  }, [selectedTab])\n\n  const onSelectTab = newTab => {\n    setSelectedTab(newTab)\n    onClick && onClick(newTab)\n  }\n\n  useEffect(() => {\n    window.addEventListener('resize', handleHideArrows)\n\n    return () => window.removeEventListener('resize', handleHideArrows)\n  }, [handleHideArrows])\n\n  useEffect(() => {\n    window.addEventListener('resize', moveToSelectedTab)\n\n    return () => window.removeEventListener('resize', moveToSelectedTab)\n  }, [moveToSelectedTab])\n\n  useEffect(() => {\n    handleHideArrows()\n  }, [tabsList, handleHideArrows])\n\n  useEffect(() => {\n    moveToSelectedTab()\n  }, [moveToSelectedTab])\n\n  useEffect(() => {\n    if (params.tab && params.tab !== selectedTab && !isDetailsPopUp) {\n      setSelectedTab(tabsList.find(tab => tab.id === params.tab)?.id)\n    }\n  }, [isDetailsPopUp, params.tab, selectedTab, tabsList])\n\n  return (\n    <div className=\"content-menu\">\n      <div\n        className={leftArrowClassNames}\n        onClick={() => {\n          scrollTabs(false)\n        }}\n      >\n        <Arrow />\n      </div>\n      <div className=\"content-menu__tabs-wrapper\" ref={tabsWrapperRef}>\n        <div\n          ref={tabsRef}\n          className=\"content-menu__tabs\"\n          style={{\n            transform: `translateX(${-scrolledWidth}px)`\n          }}\n        >\n          {tabsList.map(tab => {\n            const tabClassName = classnames(\n              'content-menu__tab',\n              `content-menu__tab-${fontSize}`,\n              selectedTab === tab.id && 'content-menu__tab_active'\n            )\n\n            return (\n              !tab.hidden &&\n              (!skipLink ? (\n                <Link\n                  to={generateUrlFromRouterPath(\n                    `${window.location.pathname?.replace(/^$|([^/]+$)/, tab.id)}${location.search ?? ''}${tab.query ?? ''}`\n                  )}\n                  className={tabClassName}\n                  key={tab.id}\n                >\n                  <span\n                    className={\n                      (tab.icon && 'content-menu__tab-icon') || (tab.tip && 'content-menu__tab-tip')\n                    }\n                    data-tab={tab.id}\n                    onClick={() => onSelectTab(tab)}\n                  >\n                    {tab.icon && <div>{tab.icon}</div>}\n                    {tab.label}\n                    {tab.tip && <Tip text={tab.tip} />}\n                  </span>\n                </Link>\n              ) : (\n                <div\n                  className={tabClassName}\n                  data-tab={tab.id}\n                  key={tab.id}\n                  onClick={() => onSelectTab(tab.id)}\n                >\n                  {tab.icon && <div className=\"content-menu_tab-icon\">{tab.icon}</div>}\n                  {tab.label}\n                  {tab.tip && <Tip className=\"content-menu__tab-tip\" text={tab.tip} />}\n                </div>\n              ))\n            )\n          })}\n        </div>\n      </div>\n      <div className={rightArrowClassNames} onClick={() => scrollTabs(true)}>\n        <Arrow />\n      </div>\n    </div>\n  )\n}\n\nTabsSlider.propTypes = {\n  fontSize: PropTypes.oneOf(['sm', 'md', 'lg']),\n  initialTab: PropTypes.string,\n  isDetailsPopUp: PropTypes.bool,\n  onClick: PropTypes.func,\n  skipLink: PropTypes.bool,\n  tabsList: SLIDER_TABS.isRequired\n}\n\nexport default TabsSlider\n"],"names":["TabsSlider","fontSize","initialTab","isDetailsPopUp","onClick","skipLink","tabsList","selectedTab","setSelectedTab","useState","arrowsAreHidden","setArrowsAreHidden","scrolledWidth","setScrolledWidth","rightArrowDisabled","setRightArrowDisabled","tabsWrapperRef","useRef","tabsRef","location","useLocation","params","useParams","menuOffsetHalfWidth","tabOffset","leftArrowClassNames","classnames","rightArrowClassNames","scrollTabs","toRight","scrollWidth","_a","_b","_c","_d","_e","_f","handleHideArrows","useCallback","scrollIsHidden","moveToSelectedTab","selectedTabNode","centeredTabPosition","onSelectTab","newTab","useEffect","tab","jsxs","jsx","Arrow","tabClassName","Tip","Link","generateUrlFromRouterPath","PropTypes","SLIDER_TABS"],"mappings":"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"}